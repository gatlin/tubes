<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tubes.Core</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Tubes-Core.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/Tubes-Core.html">Source</a></li><li><a href="/package/tubes-2.1.1.0">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">tubes-2.1.1.0: Write stream processing computations with side effects in a series of
tubes.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Trustworthy</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Tubes.Core</p></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:Tube">Tube</a> a b = FreeT (<a href="Tubes-Core.html#t:TubeF">TubeF</a> a b)</li><li class="src short"><span class="keyword">newtype</span> <a href="#t:TubeF">TubeF</a> a b k = <a href="#v:TubeF">TubeF</a> {<ul class="subs"><li><a href="#v:runTubeF">runTubeF</a> :: <span class="keyword">forall</span> r. ((a -&gt; k) -&gt; r) -&gt; ((b, k) -&gt; r) -&gt; r</li></ul>}</li><li class="src short"><a href="#v:await">await</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m a</li><li class="src short"><a href="#v:yield">yield</a> :: Monad m =&gt; b -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m ()</li><li class="src short"><a href="#v:halt">halt</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m ()</li><li class="src short"><a href="#v:-62--45-">(&gt;-)</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m r -&gt; (b -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> b c m r) -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a c m r</li><li class="src short"><a href="#v:-62--60-">(&gt;&lt;)</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m r -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> b c m r -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a c m r</li><li class="src short"><a href="#v:liftT">liftT</a> :: (MonadTrans t, Monad m) =&gt; FreeT f m a -&gt; t m (FreeF f a (FreeT f m a))</li><li class="src short"><a href="#v:diverge">diverge</a> :: a</li><li class="src short"><a href="#v:awaitF">awaitF</a> :: (a -&gt; k) -&gt; <a href="Tubes-Core.html#t:TubeF">TubeF</a> a b k</li><li class="src short"><a href="#v:yieldF">yieldF</a> :: b -&gt; k -&gt; <a href="Tubes-Core.html#t:TubeF">TubeF</a> a b k</li><li class="src short"><span class="keyword">type</span> <a href="#t:Pump">Pump</a> b a = CofreeT (<a href="Tubes-Core.html#t:PumpF">PumpF</a> b a)</li><li class="src short"><span class="keyword">data</span> <a href="#t:PumpF">PumpF</a> b a k = <a href="#v:PumpF">PumpF</a> {<ul class="subs"><li><a href="#v:sendF">sendF</a> :: a -&gt; k</li><li><a href="#v:recvF">recvF</a> :: (b, k)</li></ul>}</li><li class="src short"><a href="#v:pumpT">pumpT</a> :: Comonad w =&gt; w r -&gt; (w r -&gt; b -&gt; w r) -&gt; (w r -&gt; (a, w r)) -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r</li><li class="src short"><a href="#v:send">send</a> :: Comonad w =&gt; b -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r</li><li class="src short"><a href="#v:recv">recv</a> :: Comonad w =&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r -&gt; (a, <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r)</li><li class="src short"><a href="#v:stream">stream</a> :: (Monad m, Comonad w) =&gt; (a -&gt; b -&gt; r) -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> c d w a -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> c d m b -&gt; m r</li><li class="src short"><a href="#v:streamM">streamM</a> :: (Monad m, Comonad w) =&gt; (a -&gt; b -&gt; r) -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> c d w (m a) -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> c d m b -&gt; m r</li><li class="src short"><a href="#v:runTube">runTube</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> () () m r -&gt; m r</li><li class="src short"><a href="#v:runFreeT">runFreeT</a> :: FreeT f m a -&gt; m (FreeF f a (FreeT f m a))</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Tube" class="def">Tube</a> a b = FreeT (<a href="Tubes-Core.html#t:TubeF">TubeF</a> a b) <a href="src/Tubes-Core.html#Tube" class="link">Source</a></p><div class="doc"><p>The central data type. <code>Tube</code>s stacked on top of the same base monad <code>m</code> may be
composed in series, so long as their type arguments agree. </p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a name="t:TubeF" class="def">TubeF</a> a b k <a href="src/Tubes-Core.html#TubeF" class="link">Source</a></p><div class="doc"><p><code>TubeF</code> defines the language of <code><a href="Tubes-Core.html#t:Tube">Tube</a></code>s - namely, <code><a href="Tubes-Core.html#v:yield">yield</a></code> and <code><a href="Tubes-Core.html#v:await">await</a></code>.</p><p>This type is merely the CPS-encoded version of the following much friendlier
data type:</p><pre>    data TubeF a b k
        = Await (a -&gt; k)
        | Yield (b  , k)
        deriving (Functor)
</pre><p>This says: a tube computation is either paused awaiting upstream data, or
paused yielding data downstream. The free monad transformer fleshes out the
other cases, namely having finished with a final result value or wrapping a
lower monad.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:TubeF" class="def">TubeF</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:runTubeF" class="def">runTubeF</a> :: <span class="keyword">forall</span> r. ((a -&gt; k) -&gt; r) -&gt; ((b, k) -&gt; r) -&gt; r</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:TubeF" class="caption collapser" onclick="toggleSection('i:TubeF')">Instances</p><div id="section.i:TubeF" class="show"><table><tr><td class="src clearfix"><span class="inst-left">Functor (<a href="Tubes-Core.html#t:TubeF">TubeF</a> a b)</span> <a href="src/Tubes-Core.html#line-82" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:await" class="def">await</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m a <a href="src/Tubes-Core.html#await" class="link">Source</a></p><div class="doc"><p>Command telling a <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> computation to pause and await upstream data.</p></div></div><div class="top"><p class="src"><a name="v:yield" class="def">yield</a> :: Monad m =&gt; b -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m () <a href="src/Tubes-Core.html#yield" class="link">Source</a></p><div class="doc"><p>Command telling a <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> computation to yield data downstream and pause.</p></div></div><div class="top"><p class="src"><a name="v:halt" class="def">halt</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m () <a href="src/Tubes-Core.html#halt" class="link">Source</a></p><div class="doc"><p>Command telling a <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> with base type <code>()</code> to simply stop.</p></div></div><div class="top"><p class="src"><a name="v:-62--45-" class="def">(&gt;-)</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m r -&gt; (b -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> b c m r) -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a c m r <span class="fixity">infixl 3</span><span class="rightedge"></span> <a href="src/Tubes-Core.html#%3E-" class="link">Source</a></p><div class="doc"><p>Compose a <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> emitting values of type <code>b</code> with a continuation producing a
suitable successor.</p><p>Used primarily to define '(&gt;&lt;)'.</p></div></div><div class="top"><p class="src"><a name="v:-62--60-" class="def">(&gt;&lt;)</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a b m r -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> b c m r -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> a c m r <span class="fixity">infixl 3</span><span class="rightedge"></span> <a href="src/Tubes-Core.html#%3E%3C" class="link">Source</a></p><div class="doc"><p>Compose compatible tubes in series to produce a new <code><a href="Tubes-Core.html#t:Tube">Tube</a></code>.</p><pre>    each [1..10] &gt;<a href="map">(*2)</a>&lt; pour display
</pre></div></div><div class="top"><p class="src"><a name="v:liftT" class="def">liftT</a> :: (MonadTrans t, Monad m) =&gt; FreeT f m a -&gt; t m (FreeF f a (FreeT f m a)) <a href="src/Tubes-Core.html#liftT" class="link">Source</a></p></div><div class="top"><p class="src"><a name="v:diverge" class="def">diverge</a> :: a <a href="src/Tubes-Core.html#diverge" class="link">Source</a></p><div class="doc"><p>Used only in situations where a dummy value is needed. Actively working to
 get rid of this.</p></div></div><div class="top"><p class="src"><a name="v:awaitF" class="def">awaitF</a> :: (a -&gt; k) -&gt; <a href="Tubes-Core.html#t:TubeF">TubeF</a> a b k <a href="src/Tubes-Core.html#awaitF" class="link">Source</a></p><div class="doc"><p>Value constructor for the first <code><a href="Tubes-Core.html#t:TubeF">TubeF</a></code> case.</p></div></div><div class="top"><p class="src"><a name="v:yieldF" class="def">yieldF</a> :: b -&gt; k -&gt; <a href="Tubes-Core.html#t:TubeF">TubeF</a> a b k <a href="src/Tubes-Core.html#yieldF" class="link">Source</a></p><div class="doc"><p>Value constructor for the second <code><a href="Tubes-Core.html#t:TubeF">TubeF</a></code> case.</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Pump" class="def">Pump</a> b a = CofreeT (<a href="Tubes-Core.html#t:PumpF">PumpF</a> b a) <a href="src/Tubes-Core.html#Pump" class="link">Source</a></p><div class="doc"><p>Pumps are the dual of <code><a href="Tubes-Core.html#t:Tube">Tube</a></code>s. Where a <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> may either be <code><a href="Tubes-Core.html#v:await">await</a></code>ing or
<code><a href="Tubes-Core.html#v:yield">yield</a></code>ing, a <code><a href="Tubes-Core.html#t:Pump">Pump</a></code> is always in a position to <code><a href="Tubes-Core.html#v:send">send</a></code> or <code><a href="Tubes-Core.html#v:recv">recv</a></code> data. They are
the machines which run <code><a href="Tubes-Core.html#t:Tube">Tube</a></code>s, essentially.</p><p>Pumps may be used to formulate infinite streams and folds.</p><p>TODO: more examples!</p><p>Note the type arguments are &quot;backward&quot; from the <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> point of view: a
<code>Pump b a w r</code> may be sent values of type <code>a</code> and you may receive <code>b</code> values
from it.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:PumpF" class="def">PumpF</a> b a k <a href="src/Tubes-Core.html#PumpF" class="link">Source</a></p><div class="doc"><p>The basis for the <code><a href="Tubes-Core.html#t:Pump">Pump</a></code> comonad transformer. This says that a pump computation
can send and receive data.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:PumpF" class="def">PumpF</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:sendF" class="def">sendF</a> :: a -&gt; k</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:recvF" class="def">recvF</a> :: (b, k)</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:PumpF" class="caption collapser" onclick="toggleSection('i:PumpF')">Instances</p><div id="section.i:PumpF" class="show"><table><tr><td class="src clearfix"><span class="inst-left">Functor (<a href="Tubes-Core.html#t:PumpF">PumpF</a> b a)</span> <a href="src/Tubes-Core.html#line-176" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:pumpT" class="def">pumpT</a> :: Comonad w =&gt; w r -&gt; (w r -&gt; b -&gt; w r) -&gt; (w r -&gt; (a, w r)) -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r <a href="src/Tubes-Core.html#pumpT" class="link">Source</a></p><div class="doc"><p>Construct a <code><a href="Tubes-Core.html#t:Pump">Pump</a></code> based on an arbitrary comonad.</p></div></div><div class="top"><p class="src"><a name="v:send" class="def">send</a> :: Comonad w =&gt; b -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r <a href="src/Tubes-Core.html#send" class="link">Source</a></p><div class="doc"><p>Send a <code><a href="Tubes-Core.html#t:Pump">Pump</a></code> a value, yielding a new <code><a href="Tubes-Core.html#t:Pump">Pump</a></code>.</p></div></div><div class="top"><p class="src"><a name="v:recv" class="def">recv</a> :: Comonad w =&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r -&gt; (a, <a href="Tubes-Core.html#t:Pump">Pump</a> a b w r) <a href="src/Tubes-Core.html#recv" class="link">Source</a></p><div class="doc"><p>Receive a value from a <code><a href="Tubes-Core.html#t:Pump">Pump</a></code>, along with a new <code><a href="Tubes-Core.html#t:Pump">Pump</a></code> for the future.</p></div></div><div class="top"><p class="src"><a name="v:stream" class="def">stream</a> :: (Monad m, Comonad w) =&gt; (a -&gt; b -&gt; r) -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> c d w a -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> c d m b -&gt; m r <a href="src/Tubes-Core.html#stream" class="link">Source</a></p><div class="doc"><p>Process a <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> stream with a given <code><a href="Tubes-Core.html#t:Pump">Pump</a></code>, and merge their results.</p></div></div><div class="top"><p class="src"><a name="v:streamM" class="def">streamM</a> :: (Monad m, Comonad w) =&gt; (a -&gt; b -&gt; r) -&gt; <a href="Tubes-Core.html#t:Pump">Pump</a> c d w (m a) -&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> c d m b -&gt; m r <a href="src/Tubes-Core.html#streamM" class="link">Source</a></p><div class="doc"><p>Process a <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> stream with an effectful <code><a href="Tubes-Core.html#t:Pump">Pump</a></code>, and merge their results.</p></div></div><div class="top"><p class="src"><a name="v:runTube" class="def">runTube</a> :: Monad m =&gt; <a href="Tubes-Core.html#t:Tube">Tube</a> () () m r -&gt; m r <a href="src/Tubes-Core.html#runTube" class="link">Source</a></p><div class="doc"><p>Run a self-contained <code><a href="Tubes-Core.html#t:Tube">Tube</a></code> computation.</p></div></div><div class="top"><p class="src"><a name="v:runFreeT" class="def">runFreeT</a> :: FreeT f m a -&gt; m (FreeF f a (FreeT f m a))</p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>